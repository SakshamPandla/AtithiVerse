{% extends "base.html" %}

{% block title %}{{ destination.name }} - AtithiVerse{% endblock %}

{% block extra_css %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
    :root {
        --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        --warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        --dark-gradient: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
        --gold-gradient: linear-gradient(135deg, #f39c12 0%, #f1c40f 100%);
        --hero-overlay: linear-gradient(135deg, rgba(30, 60, 114, 0.85) 0%, rgba(42, 82, 152, 0.9) 100%);
    }

    body {
        font-family: 'Poppins', sans-serif;
        line-height: 1.6;
        color: #2c3e50;
    }

    /* ===== ENHANCED HERO SECTION WITH LEFT WEATHER ===== */
    .hero-section {
        height: 85vh;
        background: var(--dark-gradient);
        display: flex;
        align-items: center;
        color: white;
        position: relative;
        overflow: hidden;
        margin-top: -80px;
        padding-top: 80px;
    }

    .hero-bg-pattern {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: 
            radial-gradient(circle at 25% 25%, rgba(255,255,255,0.02) 0%, transparent 50%),
            radial-gradient(circle at 75% 75%, rgba(255,255,255,0.02) 0%, transparent 50%);
        z-index: 0;
    }

    .hero-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--hero-overlay);
        z-index: 1;
    }

    .hero-content {
        position: relative;
        z-index: 2;
        width: 100%;
    }

    .hero-layout {
        display: flex;
        align-items: flex-start;
        gap: 60px;
        max-width: 1400px;
        margin: 0 auto;
    }

    .hero-text-container {
        flex: 1;
        text-align: left;
        margin-bottom: 0;
    }

    .hero-bottom-section {
        display: flex;
        align-items: flex-start;
        gap: 40px;
        flex: 0 0 auto;
    }

    .hero-weather-container {
        flex: 0 0 420px;
        display: flex;
        justify-content: flex-start;
    }

    .hero-image-container {
        flex: 0 0 500px;
        position: relative;
    }

    .image-frame {
        position: relative;
        border-radius: 25px;
        overflow: hidden;
        box-shadow: 
            0 30px 60px rgba(0,0,0,0.4),
            0 0 0 1px rgba(255,255,255,0.1);
        transition: all 0.4s ease;
        background: linear-gradient(45deg, #667eea, #764ba2);
        padding: 3px;
    }

    .image-frame:hover {
        transform: scale(1.02) translateY(-10px) rotateY(2deg);
        box-shadow: 
            0 40px 80px rgba(0,0,0,0.5),
            0 0 0 1px rgba(255,255,255,0.2);
    }

    .hero-destination-image {
        width: 100%;
        height: 400px;
        object-fit: cover;
        border-radius: 22px;
        transition: transform 0.4s ease;
    }

    .image-overlay {
        position: absolute;
        top: 3px;
        left: 3px;
        right: 3px;
        bottom: 3px;
        background: linear-gradient(45deg, rgba(102,126,234,0.8), rgba(118,75,162,0.8));
        border-radius: 22px;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.4s ease;
        cursor: pointer;
    }

    .image-frame:hover .image-overlay {
        opacity: 1;
    }

    .image-overlay i {
        font-size: 3rem;
        color: white;
        transform: scale(0.8);
        transition: transform 0.3s ease;
    }

    .image-frame:hover .image-overlay i {
        transform: scale(1);
    }

    /* ===== HERO WEATHER WIDGET STYLES ===== */
    .hero-weather-widget {
        background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
        backdrop-filter: blur(25px);
        border: 2px solid rgba(255,255,255,0.2);
        border-radius: 25px;
        padding: 25px;
        color: white;
        position: relative;
        overflow: hidden;
        transition: all 0.4s ease;
        box-shadow: 0 15px 35px rgba(0,0,0,0.3);
        width: 100%;
        max-width: 420px;
    }

    .hero-weather-widget::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        transition: left 0.6s ease;
    }

    .hero-weather-widget:hover::before {
        left: 100%;
    }

    .hero-weather-widget:hover {
        transform: translateY(-8px);
        border-color: rgba(255,255,255,0.3);
        box-shadow: 0 25px 50px rgba(0,0,0,0.4);
    }

    .hero-weather-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .hero-weather-location {
        font-size: 1.2rem;
        font-weight: 700;
        opacity: 0.95;
    }

    .hero-weather-time {
        font-size: 0.9rem;
        opacity: 0.75;
        font-weight: 500;
    }

    .hero-weather-main {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 25px;
    }

    .hero-weather-icon {
        width: 80px;
        height: 80px;
        filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
        border-radius: 50%;
        background: rgba(255,255,255,0.1);
        padding: 5px;
    }

    .hero-weather-temp {
        flex: 1;
    }

    .hero-temperature {
        font-size: 3rem;
        font-weight: 800;
        margin: 0;
        text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        line-height: 1;
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .hero-weather-desc {
        font-size: 1.1rem;
        font-weight: 600;
        opacity: 0.9;
        margin: 5px 0;
        text-transform: capitalize;
    }

    .hero-feels-like {
        font-size: 0.9rem;
        opacity: 0.75;
        font-weight: 500;
    }

    .hero-weather-details {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
        margin-bottom: 20px;
    }

    .hero-weather-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 15px;
        background: rgba(255,255,255,0.08);
        border-radius: 15px;
        transition: all 0.3s ease;
    }

    .hero-weather-item:hover {
        background: rgba(255,255,255,0.15);
        transform: translateX(5px);
    }

    .hero-weather-item i {
        font-size: 1.1rem;
        color: #3498db;
        width: 18px;
        text-align: center;
        filter: drop-shadow(0 2px 4px rgba(52, 152, 219, 0.3));
    }

    .hero-weather-item div {
        display: flex;
        flex-direction: column;
        gap: 2px;
    }

    .hero-weather-label {
        font-size: 0.75rem;
        opacity: 0.7;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-weight: 500;
    }

    .hero-weather-value {
        font-weight: 700;
        font-size: 0.95rem;
    }

    .hero-sun-times {
        display: flex;
        justify-content: space-between;
        padding: 15px;
        background: rgba(255,255,255,0.08);
        border-radius: 15px;
    }

    .hero-sun-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.9rem;
        font-weight: 600;
    }

    .hero-sun-item i {
        color: #f39c12;
        filter: drop-shadow(0 2px 4px rgba(243, 156, 18, 0.3));
        font-size: 1rem;
    }

    .weather-loading {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 50px 20px;
        color: white;
        text-align: center;
    }

    .weather-loading i {
        font-size: 2.5rem;
        margin-bottom: 15px;
        animation: pulse 2s ease-in-out infinite;
        color: #3498db;
    }

    @keyframes pulse {
        0%, 100% { opacity: 0.6; transform: scale(1); }
        50% { opacity: 1; transform: scale(1.05); }
    }

    .weather-error {
        text-align: center;
        padding: 40px 20px;
        color: rgba(255,255,255,0.8);
    }

    .weather-error i {
        font-size: 2rem;
        color: #e74c3c;
        margin-bottom: 15px;
    }

    /* ===== 5-DAY FORECAST STYLES ===== */
    .forecast-toggle-container {
        margin-top: 20px;
        text-align: center;
    }

    .forecast-toggle {
        background: rgba(255,255,255,0.1);
        border: 2px solid rgba(255,255,255,0.3);
        color: white;
        padding: 8px 20px;
        border-radius: 25px;
        font-size: 0.9rem;
        font-weight: 600;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
    }

    .forecast-toggle:hover {
        background: rgba(255,255,255,0.2);
        border-color: rgba(255,255,255,0.5);
        transform: translateY(-2px);
        color: white;
    }

    .forecast-section {
        background: rgba(255,255,255,0.1);
        backdrop-filter: blur(25px);
        border: 2px solid rgba(255,255,255,0.2);
        border-radius: 20px;
        margin-top: 20px;
        padding: 20px;
        color: white;
        position: relative;
        overflow: hidden;
    }

    .forecast-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        transition: left 0.6s ease;
    }

    .forecast-section:hover::before {
        left: 100%;
    }

    .forecast-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .forecast-title {
        font-size: 1.1rem;
        font-weight: 700;
        margin: 0;
        color: white;
    }

    .forecast-loading,
    .forecast-error {
        text-align: center;
        padding: 30px 20px;
        color: rgba(255,255,255,0.8);
    }

    .forecast-loading i,
    .forecast-error i {
        font-size: 1.5rem;
        margin-bottom: 10px;
        display: block;
    }

    .forecast-loading i {
        color: #3498db;
        animation: spin 1s linear infinite;
    }

    .forecast-error i {
        color: #e74c3c;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .forecast-days {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 15px;
    }

    .forecast-day {
        background: rgba(255,255,255,0.08);
        border-radius: 15px;
        padding: 15px 10px;
        text-align: center;
        transition: all 0.3s ease;
        border: 1px solid rgba(255,255,255,0.1);
    }

    .forecast-day:hover {
        background: rgba(255,255,255,0.15);
        transform: translateY(-3px);
        border-color: rgba(255,255,255,0.2);
    }

    .forecast-day-name {
        font-size: 0.85rem;
        font-weight: 600;
        margin-bottom: 8px;
        opacity: 0.9;
    }

    .forecast-day-date {
        font-size: 0.75rem;
        opacity: 0.7;
        margin-bottom: 10px;
    }

    .forecast-day-icon {
        width: 40px;
        height: 40px;
        margin: 0 auto 10px;
        filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    }

    .forecast-day-temps {
        margin-bottom: 8px;
    }

    .forecast-day-max {
        font-size: 1.1rem;
        font-weight: 700;
        color: white;
    }

    .forecast-day-min {
        font-size: 0.9rem;
        opacity: 0.7;
        margin-left: 5px;
    }

    .forecast-day-desc {
        font-size: 0.75rem;
        opacity: 0.8;
        margin-bottom: 8px;
        text-transform: capitalize;
    }

    .forecast-day-details {
        display: flex;
        justify-content: space-between;
        font-size: 0.7rem;
        opacity: 0.7;
    }

    .forecast-day-detail {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 2px;
    }

    .forecast-day-detail i {
        font-size: 0.8rem;
        color: #3498db;
    }

    /* Responsive forecast */
    @media (max-width: 768px) {
        .forecast-days {
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .forecast-day {
            padding: 12px 8px;
        }
        
        .forecast-day-icon {
            width: 35px;
            height: 35px;
        }
    }

    @media (max-width: 576px) {
        .forecast-days {
            grid-template-columns: 1fr;
        }
    }

    /* ===== TEXT CONTENT STYLES ===== */
    .hero-text-container {
        flex: 1;
    }

    .destination-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: var(--gold-gradient);
        padding: 10px 25px;
        border-radius: 30px;
        font-size: 0.9rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        box-shadow: 0 8px 25px rgba(243, 156, 18, 0.4);
        border: 2px solid rgba(255,255,255,0.2);
        animation: pulse-glow 3s ease-in-out infinite;
    }

    @keyframes pulse-glow {
        0%, 100% { box-shadow: 0 8px 25px rgba(243, 156, 18, 0.4); }
        50% { box-shadow: 0 8px 35px rgba(243, 156, 18, 0.6); }
    }

    .hero-title {
        font-size: 3.5rem;
        font-weight: 900;
        margin-bottom: 1rem;
        text-shadow: 0 8px 32px rgba(0,0,0,0.5);
        line-height: 1.1;
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 50%, #e9ecef 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: -1px;
    }

    .hero-location {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 1.3rem;
        margin-bottom: 1.5rem;
        opacity: 0.95;
        font-weight: 500;
    }

    .hero-location i {
        font-size: 1.2rem;
        color: #3498db;
        filter: drop-shadow(0 4px 8px rgba(52, 152, 219, 0.4));
    }

    .rating-display {
        background: rgba(255,255,255,0.12);
        backdrop-filter: blur(20px);
        border-radius: 35px;
        padding: 15px 30px;
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 1.8rem;
        border: 2px solid rgba(255,255,255,0.15);
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        max-width: fit-content;
    }

    .rating-stars {
        display: flex;
        align-items: center;
        gap: 4px;
    }

    .rating-stars i {
        color: #f39c12;
        font-size: 1.1rem;
        filter: drop-shadow(0 3px 6px rgba(243, 156, 18, 0.5));
        transition: transform 0.3s ease;
    }

    .rating-stars:hover i {
        transform: scale(1.1) rotate(15deg);
    }

    .rating-text {
        font-weight: 700;
        font-size: 1.1rem;
        color: #ffffff;
    }

    .rating-count {
        font-weight: 500;
        font-size: 0.9rem;
        color: rgba(255,255,255,0.8);
    }

    .feature-pills {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 2rem;
    }

    .feature-pill {
        background: rgba(255,255,255,0.15);
        backdrop-filter: blur(15px);
        border: 2px solid rgba(255,255,255,0.2);
        color: white;
        padding: 8px 18px;
        border-radius: 25px;
        font-size: 0.85rem;
        font-weight: 600;
        text-shadow: 0 2px 8px rgba(0,0,0,0.3);
        transition: all 0.4s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        position: relative;
        overflow: hidden;
    }

    .feature-pill::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.6s ease;
    }

    .feature-pill:hover {
        background: rgba(255,255,255,0.25);
        transform: translateY(-3px);
        box-shadow: 0 12px 25px rgba(0,0,0,0.3);
        border-color: rgba(255,255,255,0.4);
    }

    .feature-pill:hover::before {
        left: 100%;
    }

    .feature-pill i {
        font-size: 0.8rem;
        color: #27ae60;
        filter: drop-shadow(0 2px 6px rgba(39, 174, 96, 0.4));
    }

    .hero-actions {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
    }

    .btn-hero-primary,
    .btn-hero-outline {
        padding: 14px 32px;
        border-radius: 30px;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.4s ease;
        display: flex;
        align-items: center;
        gap: 10px;
        position: relative;
        overflow: hidden;
    }

    .btn-hero-primary::before,
    .btn-hero-outline::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.6s ease;
    }

    .btn-hero-primary {
        background: var(--secondary-gradient);
        border: none;
        color: white;
        box-shadow: 0 10px 30px rgba(240, 147, 251, 0.4);
    }

    .btn-hero-primary:hover {
        transform: translateY(-4px);
        box-shadow: 0 15px 40px rgba(240, 147, 251, 0.6);
        color: white;
    }

    .btn-hero-outline {
        background: rgba(255,255,255,0.1);
        border: 2px solid rgba(255,255,255,0.3);
        color: white;
        backdrop-filter: blur(15px);
    }

    .btn-hero-outline:hover {
        background: rgba(255,255,255,0.2);
        border-color: rgba(255,255,255,0.5);
        transform: translateY(-4px);
        box-shadow: 0 12px 25px rgba(0,0,0,0.3);
        color: white;
    }

    .btn-hero-primary:hover::before,
    .btn-hero-outline:hover::before {
        left: 100%;
    }

    /* ===== FLOATING DECORATIONS ===== */
    .hero-decoration {
        position: absolute;
        border-radius: 50%;
        z-index: 1;
        animation: float 12s ease-in-out infinite;
    }

    .hero-decoration:nth-child(3) {
        top: 10%;
        right: 8%;
        width: 160px;
        height: 160px;
        background: radial-gradient(circle, rgba(52, 152, 219, 0.08) 0%, transparent 70%);
    }

    .hero-decoration:nth-child(4) {
        bottom: 15%;
        left: 5%;
        width: 120px;
        height: 120px;
        background: radial-gradient(circle, rgba(46, 204, 113, 0.08) 0%, transparent 70%);
        animation-delay: -6s;
    }

    .hero-decoration:nth-child(5) {
        top: 45%;
        right: 15%;
        width: 80px;
        height: 80px;
        background: radial-gradient(circle, rgba(241, 196, 15, 0.08) 0%, transparent 70%);
        animation-delay: -3s;
    }

    @keyframes float {
        0%, 100% { 
            transform: translateY(0px) rotate(0deg); 
            opacity: 0.6;
        }
        50% { 
            transform: translateY(-25px) rotate(180deg); 
            opacity: 1;
        }
    }

    /* ===== MAIN CONTENT STYLES ===== */
    .main-content {
        background: linear-gradient(180deg, #f8f9fa 0%, #ffffff 100%);
        margin-top: -50px;
        position: relative;
        z-index: 3;
        border-radius: 50px 50px 0 0;
        padding: 80px 0 60px;
    }

    /* ===== BEAUTIFUL WEATHER APP STYLES ===== */
    .weather-section {
        margin-bottom: 60px;
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
        border-radius: 25px;
        padding: 40px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        border: 1px solid rgba(255,255,255,0.8);
        position: relative;
        overflow: hidden;
    }

    .weather-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
    }

    .weather-container {
        display: flex;
        flex-direction: column;
        gap: 35px;
        position: relative;
        z-index: 2;
    }

    .current-weather-widget {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 35px;
        color: #2c3e50;
        border: 1px solid rgba(255,255,255,0.3);
        box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        position: relative;
    }

    .weather-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid #f1f3f4;
    }

    .weather-location {
        font-size: 1.4rem;
        font-weight: 800;
        color: #2c3e50;
        margin: 0;
        letter-spacing: -0.5px;
    }

    .weather-time {
        font-size: 0.95rem;
        color: #6c757d;
        font-weight: 600;
        margin: 0;
        background: #f8f9fa;
        padding: 8px 16px;
        border-radius: 20px;
        border: 1px solid #e9ecef;
    }

    .weather-main {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 30px;
        padding: 20px 0;
    }

    .weather-temp-section {
        display: flex;
        align-items: center;
        gap: 25px;
    }

    .weather-icon {
        width: 100px;
        height: 100px;
        filter: drop-shadow(0 8px 16px rgba(0,0,0,0.15));
        transition: transform 0.3s ease;
    }

    .weather-icon:hover {
        transform: scale(1.05);
    }

    .weather-temp {
        display: flex;
        flex-direction: column;
    }

    .temperature {
        font-size: 4rem;
        font-weight: 900;
        margin: 0;
        color: #2c3e50;
        line-height: 0.9;
        letter-spacing: -2px;
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .weather-desc {
        font-size: 1.2rem;
        font-weight: 700;
        color: #6c757d;
        margin: 8px 0 5px 0;
        text-transform: capitalize;
    }

    .feels-like {
        font-size: 1rem;
        color: #868e96;
        font-weight: 500;
    }

    .weather-high-low {
        text-align: right;
        font-size: 1rem;
        color: #6c757d;
        font-weight: 600;
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        padding: 12px 20px;
        border-radius: 15px;
        border: 1px solid #e9ecef;
    }

    .weather-details {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin-top: 25px;
    }

    .weather-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 18px 20px;
        background: linear-gradient(135deg, #f8f9fa, #ffffff);
        border-radius: 15px;
        transition: all 0.3s ease;
        border: 1px solid #e9ecef;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .weather-item:hover {
        background: linear-gradient(135deg, #e9ecef, #f8f9fa);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }

    .weather-item i {
        font-size: 1.4rem;
        color: #667eea;
        width: 24px;
        text-align: center;
    }

    .weather-item div {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .weather-label {
        font-size: 0.8rem;
        color: #6c757d;
        text-transform: uppercase;
        letter-spacing: 0.8px;
        font-weight: 600;
    }

    .weather-value {
        font-weight: 800;
        font-size: 1.1rem;
        color: #2c3e50;
    }

    .forecast-widget {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        padding: 35px;
        color: #2c3e50;
        border: 1px solid rgba(255,255,255,0.3);
        box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        position: relative;
    }

    .forecast-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        padding-bottom: 20px;
        border-bottom: 2px solid #f1f3f4;
    }

    .forecast-title {
        font-size: 1.3rem;
        font-weight: 800;
        margin: 0;
        color: #2c3e50;
        letter-spacing: -0.5px;
    }

    .forecast-toggle {
        background: linear-gradient(135deg, #667eea, #764ba2);
        border: none;
        color: white;
        padding: 12px 24px;
        border-radius: 25px;
        font-weight: 600;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .forecast-toggle:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        color: white;
    }

    .forecast-loading,
    .forecast-error {
        text-align: center;
        padding: 30px 20px;
        color: #6c757d;
    }

    .forecast-loading i,
    .forecast-error i {
        font-size: 1.5rem;
        margin-bottom: 10px;
        display: block;
    }

    .forecast-loading i {
        color: #3498db;
        animation: spin 1s linear infinite;
    }

    .forecast-error i {
        color: #e74c3c;
    }

    .forecast-days {
        display: flex;
        flex-direction: row;
        flex-wrap: nowrap;
        align-items: stretch;
        gap: 20px;
        overflow-x: auto;
        overflow-y: hidden;
        padding: 5px 4px 15px;
        scrollbar-width: thin;
        scrollbar-color: #667eea #f1f3f4;
    }

    .forecast-days::-webkit-scrollbar {
        height: 6px;
    }

    .forecast-days::-webkit-scrollbar-track {
        background: #f1f3f4;
        border-radius: 3px;
    }

    .forecast-days::-webkit-scrollbar-thumb {
        background: linear-gradient(90deg, #667eea, #764ba2);
        border-radius: 3px;
    }

    .forecast-widget .forecast-content { width: 100%; }

    .forecast-day {
        background: transparent;
        border-radius: 22px;
        padding: 0;
        display: flex;
        flex-direction: column;
        align-items: stretch;
        gap: 0;
        transition: all 0.3s ease;
        min-width: 160px;
        flex-shrink: 0;
        position: relative;
    }

    .forecast-day::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #667eea, #764ba2);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .forecast-day:hover { transform: translateY(-5px); }

    .forecast-day:hover::before {
        opacity: 1;
    }

    .forecast-day-icon { width: 56px; height: 56px; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.1)); }

    .forecast-day:hover .forecast-day-icon {
        transform: scale(1.1);
    }

    /* New card structure to match reference image */
    .fc-card {
        background: rgba(255,255,255,0.9);
        border-radius: 22px;
        border: 1px solid #e9ecef;
        overflow: hidden;
        box-shadow: 0 8px 24px rgba(0,0,0,0.12);
        display: flex;
        flex-direction: column;
        align-items: stretch;
        height: 100%;
    }

    .fc-day-header {
        font-size: 1.2rem;
        font-weight: 900;
        color: #2c3e50;
        text-align: center;
        padding: 14px 12px 10px;
        background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
    }

    .fc-icon-wrap { display: flex; justify-content: center; padding: 18px 0 6px; }

    .fc-desc {
        text-align: center;
        font-size: 1rem;
        font-weight: 700;
        color: #2f3b48;
        min-height: 40px;
        padding: 4px 10px 12px;
    }

    .fc-temp-band {
        margin-top: auto;
        background: linear-gradient(180deg, rgba(0,0,0,0.06), rgba(0,0,0,0.12));
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0;
        align-items: center;
        justify-items: center;
        padding: 14px 8px;
        color: #111827;
    }

    .fc-temp-high { font-size: 1.6rem; font-weight: 900; }
    .fc-temp-low  { font-size: 1.4rem; font-weight: 800; opacity: 0.9; }

    .forecast-day-details {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 4px;
    }

    .forecast-day-name {
        font-size: 0.9rem;
        font-weight: 700;
        color: #2c3e50;
        margin: 0;
    }

    .forecast-day-date {
        font-size: 0.8rem;
        color: #6c757d;
        font-weight: 600;
    }

    .forecast-day-temps {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 1rem;
        font-weight: 700;
        color: #2c3e50;
        margin-top: 5px;
    }

    .forecast-day-max {
        font-size: 1.1rem;
        font-weight: 800;
        color: #2c3e50;
    }

    .forecast-day-min {
        font-size: 0.9rem;
        color: #6c757d;
        font-weight: 600;
    }

    .forecast-day-desc {
        font-size: 0.8rem;
        color: #6c757d;
        text-transform: capitalize;
        text-align: center;
        font-weight: 500;
    }

    .forecast-day-metrics {
        display: none; /* Hide metrics for cleaner look */
    }

    /* Responsive weather section */
    @media (max-width: 768px) {
        .weather-section {
            padding: 25px;
            margin: 0 -15px 40px;
            border-radius: 20px;
        }
        
        .weather-main {
            flex-direction: column;
            align-items: flex-start;
            gap: 20px;
        }
        
        .weather-high-low {
            align-self: flex-end;
        }
        
        .weather-details {
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .forecast-days {
            gap: 15px;
        }
        
        .forecast-day {
            min-width: 100px;
            padding: 15px;
        }
        
        .temperature {
            font-size: 3.5rem;
        }
        
        .weather-icon {
            width: 80px;
            height: 80px;
        }
    }

    @media (max-width: 576px) {
        .weather-section {
            padding: 20px;
        }
        
        .current-weather-widget,
        .forecast-widget {
            padding: 25px;
        }
        
        .temperature {
            font-size: 3rem;
        }
        
        .weather-icon {
            width: 70px;
            height: 70px;
        }
        
        .forecast-day {
            min-width: 90px;
            padding: 12px;
        }
        
        .weather-details {
            grid-template-columns: 1fr;
        }
    }

    .info-card {
        border: none;
        border-radius: 25px;
        box-shadow: 0 8px 30px rgba(0,0,0,0.08);
        transition: all 0.4s ease;
        overflow: hidden;
        background: white;
        margin-bottom: 30px;
    }

    .info-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 20px 50px rgba(0,0,0,0.12);
    }

    .card-header-custom {
        background: var(--primary-gradient);
        color: white;
        border: none;
        padding: 25px 30px;
        position: relative;
        overflow: hidden;
    }

    .card-header-custom::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
        transform: translateX(-100%);
        transition: transform 0.6s ease;
    }

    .info-card:hover .card-header-custom::before {
        transform: translateX(100%);
    }

    .card-header-custom h2 {
        font-weight: 700;
        font-size: 1.5rem;
    }

    .sidebar-card {
        border: none;
        border-radius: 25px;
        box-shadow: 0 8px 30px rgba(0,0,0,0.08);
        margin-bottom: 30px;
        overflow: hidden;
        background: white;
        transition: all 0.4s ease;
    }

    .sidebar-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 40px rgba(0,0,0,0.12);
    }

    .price-highlight {
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 800;
    }

    .btn-gradient {
        background: var(--primary-gradient);
        border: none;
        border-radius: 30px;
        padding: 14px 35px;
        color: white;
        font-weight: 600;
        transition: all 0.4s ease;
        box-shadow: 0 6px 20px rgba(102,126,234,0.3);
        position: relative;
        overflow: hidden;
    }

    .btn-gradient::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.6s ease;
    }

    .btn-gradient:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(102,126,234,0.4);
        color: white;
    }

    .btn-gradient:hover::before {
        left: 100%;
    }

    .back-btn {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 70px;
        height: 70px;
        border-radius: 50%;
        background: var(--primary-gradient);
        border: none;
        color: white;
        font-size: 1.4rem;
        box-shadow: 0 8px 25px rgba(102,126,234,0.4);
        transition: all 0.4s ease;
        z-index: 1000;
        display: none;
    }

    .back-btn:hover {
        transform: scale(1.1) translateY(-5px);
        box-shadow: 0 15px 35px rgba(102,126,234,0.5);
        color: white;
    }

    /* ===== RESPONSIVE DESIGN ===== */
    @media (max-width: 1400px) {
        .hero-layout {
            gap: 40px;
        }
        
        .hero-image-container {
            flex: 0 0 450px;
        }
        
        .hero-destination-image {
            height: 350px;
        }
        
        .hero-weather-widget {
            max-width: 380px;
        }
    }

    @media (max-width: 1200px) {
        .hero-layout {
            gap: 30px;
        }
        
        .hero-image-container {
            flex: 0 0 400px;
        }
        
        .hero-destination-image {
            height: 320px;
        }
        
        .hero-title {
            font-size: 3rem;
        }
        
        .hero-weather-widget {
            max-width: 350px;
        }
    }

    @media (max-width: 1200px) {
        .hero-layout {
            gap: 40px;
        }
        
        .hero-weather-container {
            flex: 0 0 380px;
        }
        
        .hero-image-container {
            flex: 0 0 450px;
        }
    }

    @media (max-width: 992px) {
        .hero-section {
            height: auto;
            min-height: 100vh;
            padding: 120px 0 60px;
        }
        
        .hero-layout {
            flex-direction: column;
            gap: 30px;
            text-align: center;
        }
        
        .hero-text-container {
            text-align: center;
        }
        
        .hero-bottom-section {
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }
        
        .hero-weather-container {
            flex: none;
            width: 100%;
            max-width: 500px;
            justify-content: center;
        }
        
        .hero-image-container {
            flex: none;
            width: 100%;
            max-width: 500px;
        }
        
        .hero-weather-widget {
            max-width: 100%;
            width: 100%;
        }
        
        .hero-title {
            font-size: 2.8rem;
        }
        
        .rating-display {
            margin: 0 auto 1.8rem;
        }
        
        .feature-pills {
            justify-content: center;
        }
        
        .hero-actions {
            justify-content: center;
        }
    }

    @media (max-width: 768px) {
        .hero-section {
            padding: 100px 0 50px;
        }
        
        .hero-weather-details {
            grid-template-columns: 1fr;
            gap: 8px;
        }
        
        .hero-weather-main {
            flex-direction: column;
            text-align: center;
            gap: 15px;
        }
        
        .hero-weather-icon {
            width: 60px;
            height: 60px;
        }
        
        .hero-temperature {
            font-size: 2.5rem;
        }
        
        .hero-sun-times {
            flex-direction: column;
            gap: 8px;
            text-align: center;
        }
        
        .hero-title {
            font-size: 2.2rem;
        }
        
        .hero-actions {
            flex-direction: column;
            gap: 12px;
            width: 100%;
        }
        
        .btn-hero-primary,
        .btn-hero-outline {
            width: 100%;
            max-width: 280px;
            justify-content: center;
        }
        
        .main-content {
            margin-top: -30px;
            border-radius: 30px 30px 0 0;
            padding: 60px 0 40px;
        }
    }

    @media (max-width: 576px) {
        .hero-weather-widget {
            padding: 20px;
        }
        
        .hero-title {
            font-size: 1.8rem;
        }
        
        .feature-pill {
            padding: 6px 15px;
            font-size: 0.8rem;
        }
        
        .btn-hero-primary,
        .btn-hero-outline {
            padding: 12px 25px;
            font-size: 0.9rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Stunning Enhanced Hero Section with Left Weather Widget -->
<section class="hero-section">
    <!-- Background Pattern -->
    <div class="hero-bg-pattern"></div>
    
    <!-- Gradient Overlay -->
    <div class="hero-overlay"></div>
    
    <!-- Floating Decorations -->
    <div class="hero-decoration"></div>
    <div class="hero-decoration"></div>
    <div class="hero-decoration"></div>
    
    <div class="container">
        <div class="hero-content">
            <div class="hero-layout" data-aos="fade-up">
                <!-- Left Side: Text Content -->
                <div class="hero-text-container" data-aos="fade-right" data-aos-delay="300">
                        <div class="destination-badge">
                            <i class="fas fa-crown me-2"></i>UNESCO World Heritage
                        </div>
                        
                        <h1 class="hero-title">
                            {{ destination.name }}
                        </h1>
                        
                        <div class="hero-location">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>{{ destination.location }}</span>
                        </div>
                        
                        <div class="rating-display">
                            <div class="rating-stars">
                                {% for i in range(5) %}
                                    {% if i < destination.rating %}
                                        <i class="fas fa-star"></i>
                                    {% else %}
                                        <i class="far fa-star"></i>
                                    {% endif %}
                                {% endfor %}
                            </div>
                            <span class="rating-text">{{ destination.rating }}</span>
                            <span class="rating-count">{{ destination.reviews }} reviews</span>
                        </div>
                        
                        {% if destination.features %}
                        <div class="feature-pills">
                            {% for feature in destination.features[:3] %}
                            <span class="feature-pill">
                                <i class="fas fa-check"></i>{{ feature }}
                            </span>
                            {% endfor %}
                        </div>
                        {% endif %}
                        
                        <div class="hero-actions">
                            <button class="btn btn-hero-primary" onclick="planVisit()">
                                <i class="fas fa-calendar-alt me-2"></i>Plan Visit
                            </button>
                            <button class="btn btn-hero-outline" onclick="toggleWishlist({{ destination.id }})">
                                <i class="fas fa-heart me-2"></i>Wishlist
                            </button>
                    </div>
                </div>
                
                <!-- Right Side: Destination Image -->
                <div class="hero-image-container" data-aos="zoom-in" data-aos-delay="400">
                    <div class="image-frame">
                        <img src="{{ destination.image }}" 
                             alt="{{ destination.name }}" 
                             class="hero-destination-image"
                             loading="eager">
                        <div class="image-overlay" onclick="openImageModal('{{ destination.image }}')">
                            <i class="fas fa-search-plus"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Enhanced Main Content -->
<div class="main-content">
    <div class="container">
        <!-- Weather Section -->
        <div class="weather-section" data-aos="fade-up" data-aos-delay="200">
            <div class="row">
                <div class="col-12">
                    <div class="weather-container">
                        <!-- Current Weather Widget -->
                        <div class="current-weather-widget" id="currentWeatherWidget">
                            <!-- Loading State -->
                            <div class="weather-loading" id="currentWeatherLoading">
                                <i class="fas fa-cloud-sun"></i>
                                <span>Loading weather...</span>
                            </div>
                            
                            <!-- Error State -->
                            <div class="weather-error d-none" id="currentWeatherError">
                                <i class="fas fa-exclamation-triangle"></i>
                                <div>Weather unavailable</div>
                            </div>
                            
                            <!-- Weather Content -->
                            <div class="weather-content d-none" id="currentWeatherContent">
                                <!-- Header -->
                                <div class="weather-header">
                                    <div class="weather-location" id="currentWeatherLocation"></div>
                                    <div class="weather-time" id="currentWeatherTime"></div>
                                </div>
                                
                                <!-- Main Weather Info -->
                                <div class="weather-main">
                                    <div class="weather-temp-section">
                                        <img id="currentWeatherIcon" class="weather-icon" src="" alt="Weather">
                                        <div class="weather-temp">
                                            <h2 class="temperature" id="currentTemperature"></h2>
                                            <div class="weather-desc" id="currentWeatherDesc"></div>
                                        </div>
                                    </div>
                                    
                                    <!-- High/Low Temperature -->
                                    <div class="weather-high-low" id="currentHighLow">
                                        H 34° L 25°
                                    </div>
                                </div>
                                
                                <!-- Weather Details Grid -->
                                <div class="weather-details">
                                    <div class="weather-item">
                                        <i class="fas fa-tint"></i>
                                        <div>
                                            <span class="weather-label">Humidity</span>
                                            <span class="weather-value" id="currentHumidity"></span>
                                        </div>
                                    </div>
                                    <div class="weather-item">
                                        <i class="fas fa-wind"></i>
                                        <div>
                                            <span class="weather-label">Wind</span>
                                            <span class="weather-value" id="currentWindSpeed"></span>
                                        </div>
                                    </div>
                                    <div class="weather-item">
                                        <i class="fas fa-thermometer-half"></i>
                                        <div>
                                            <span class="weather-label">Pressure</span>
                                            <span class="weather-value" id="currentPressure"></span>
                                        </div>
                                    </div>
                                    <div class="weather-item">
                                        <i class="fas fa-eye"></i>
                                        <div>
                                            <span class="weather-label">Visibility</span>
                                            <span class="weather-value" id="currentVisibility"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 5-Day Forecast Widget -->
                        <div class="forecast-widget" id="forecastWidget">
                            <div class="forecast-header">
                                <h6 class="forecast-title">
                                    <i class="fas fa-calendar-week me-2"></i>5-Day Weather Forecast
                                </h6>
                                <button class="btn btn-outline-primary btn-sm forecast-toggle" onclick="toggleForecast()">
                                    <i class="fas fa-calendar-alt me-2"></i>Hide Forecast
                                </button>
                            </div>
                            
                            <div class="forecast-loading" id="forecastLoading">
                                <i class="fas fa-spinner fa-spin"></i>
                                <span>Loading forecast...</span>
                            </div>
                            
                            <div class="forecast-error d-none" id="forecastError">
                                <i class="fas fa-exclamation-triangle"></i>
                                <span>Forecast unavailable</span>
                            </div>
                            
                            <div class="forecast-content" id="forecastContent">
                                <div class="forecast-days" id="forecastDays">
                                    <!-- Forecast days will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <!-- Main Content Column -->
            <div class="col-lg-8">
                <!-- About Section -->
                <div class="info-card" data-aos="fade-right">
                    <div class="card-header-custom">
                        <h2 class="mb-0">
                            <i class="fas fa-info-circle me-2"></i>About {{ destination.name }}
                        </h2>
                    </div>
                    <div class="card-body p-4">
                        <p class="fs-6 lh-lg">{{ destination.long_description or destination.description }}</p>
                        
                        {% if destination.included %}
                        <div class="mt-4">
                            <h5 class="fw-bold text-success mb-3">
                                <i class="fas fa-check-circle me-2"></i>What's Included
                            </h5>
                            <div class="row">
                                {% for item in destination.included %}
                                <div class="col-md-6 mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-check text-success me-2"></i>
                                        <span>{{ item }}</span>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                        
                        {% if destination.excluded %}
                        <div class="mt-4">
                            <h5 class="fw-bold text-danger mb-3">
                                <i class="fas fa-times-circle me-2"></i>What's Not Included
                            </h5>
                            <div class="row">
                                {% for item in destination.excluded %}
                                <div class="col-md-6 mb-2">
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-times text-danger me-2"></i>
                                        <span>{{ item }}</span>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Enhanced Sidebar -->
            <div class="col-lg-4">
                <!-- Pricing Information -->
                <div class="sidebar-card" data-aos="fade-left" data-aos-delay="100">
                    <div class="card-body p-4">
                        <h5 class="card-title fw-bold mb-3">
                            <i class="fas fa-rupee-sign text-primary me-2"></i>Pricing Information
                        </h5>
                        <div class="mb-3">
                            <strong>Starting from:</strong> 
                            <span class="fs-4 fw-bold price-highlight">₹{{ destination.price }}</span>
                        </div>
                        {% if destination.original_price %}
                        <div class="mb-2">
                            <strong>Original Price:</strong> 
                            <span class="text-decoration-line-through text-muted">₹{{ destination.original_price }}</span>
                            <span class="badge bg-success ms-2">
                                Save ₹{{ destination.original_price - destination.price }}
                            </span>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Duration & Info -->
                <div class="sidebar-card" data-aos="fade-left" data-aos-delay="200">
                    <div class="card-body p-4">
                        <h5 class="card-title fw-bold mb-3">
                            <i class="fas fa-clock text-primary me-2"></i>Trip Information
                        </h5>
                        {% if destination.duration %}
                        <div class="mb-2">
                            <strong>Duration:</strong> {{ destination.duration }}
                        </div>
                        {% endif %}
                        {% if destination.max_people %}
                        <div class="mb-2">
                            <strong>Max People:</strong> {{ destination.max_people }} guests
                        </div>
                        {% endif %}
                        {% if destination.best_season %}
                        <div class="alert alert-info">
                            <i class="fas fa-sun text-warning me-1"></i>Best Season: {{ destination.best_season }}
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="sidebar-card" data-aos="fade-left" data-aos-delay="300">
                    <div class="card-body p-4 text-center">
                        <button class="btn btn-gradient btn-lg w-100 mb-3" onclick="toggleWishlist({{ destination.id }})">
                            <i class="fas fa-heart me-2"></i>Add to Wishlist
                        </button>
                        <button class="btn btn-outline-primary w-100 mb-3" onclick="shareDestination()">
                            <i class="fas fa-share me-2"></i>Share Destination
                        </button>
                        <button class="btn btn-outline-secondary w-100" onclick="window.history.back()">
                            <i class="fas fa-arrow-left me-2"></i>Go Back
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Enhanced Back to Top Button -->
<button class="back-btn" onclick="scrollToTop()" title="Back to Top">
    <i class="fas fa-arrow-up"></i>
</button>

<!-- Enhanced Image Modal -->
<div class="modal fade" id="imageModal" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body p-0">
                <img id="modalImage" src="" alt="" class="w-100 h-100" style="object-fit: cover; max-height: 80vh;">
                <button type="button" class="btn-close position-absolute top-0 end-0 m-3" 
                        data-bs-dismiss="modal" style="background: rgba(0,0,0,0.7); border-radius: 50%; color: white;"></button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script>
    // Initialize AOS animations
    AOS.init({
        duration: 1000,
        once: true,
        offset: 100
    });

    // Image modal functionality
    function openImageModal(imageSrc) {
        document.getElementById('modalImage').src = imageSrc;
        new bootstrap.Modal(document.getElementById('imageModal')).show();
    }

    // Plan visit functionality
    function planVisit() {
        showToast('Planning your visit... (Feature coming soon!)', 'info');
    }

    // Enhanced wishlist functionality
    async function toggleWishlist(destinationId) {
        try {
            const response = await fetch('/api/wishlist', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    destination_id: destinationId
                })
            });

            const data = await response.json();

            if (data.success) {
                showToast(data.message, 'success');
            } else {
                if (data.message.includes('Authentication required')) {
                    showToast('Please login to add items to wishlist', 'warning');
                    setTimeout(() => {
                        window.location.href = '/login';
                    }, 2000);
                } else {
                    showToast(data.message, 'error');
                }
            }
        } catch (error) {
            console.error('Error:', error);
            showToast('Error updating wishlist', 'error');
        }
    }

    // Enhanced share functionality
    function shareDestination() {
        if (navigator.share) {
            navigator.share({
                title: '{{ destination.name }} - AtithiVerse',
                text: '{{ destination.description }}',
                url: window.location.href
            });
        } else {
            // Fallback: copy to clipboard
            navigator.clipboard.writeText(window.location.href).then(() => {
                showToast('Link copied to clipboard!', 'success');
            });
        }
    }

    // Smooth scroll to top
    function scrollToTop() {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    }

    // Enhanced toast notification system
    function showToast(message, type = 'info') {
        let toastContainer = document.getElementById('toast-container');
        if (!toastContainer) {
            toastContainer = document.createElement('div');
            toastContainer.id = 'toast-container';
            toastContainer.className = 'toast-container position-fixed top-0 end-0 p-3';
            toastContainer.style.zIndex = '1080';
            document.body.appendChild(toastContainer);
        }

        const toast = document.createElement('div');
        toast.className = `toast align-items-center text-white bg-${type === 'error' ? 'danger' : type === 'warning' ? 'warning' : type === 'success' ? 'success' : 'primary'} border-0`;
        toast.setAttribute('role', 'alert');
        toast.style.borderRadius = '15px';
        toast.style.boxShadow = '0 8px 25px rgba(0,0,0,0.2)';
        toast.innerHTML = `
            <div class="d-flex">
                <div class="toast-body">
                    <i class="fas fa-${type === 'error' ? 'times-circle' : type === 'warning' ? 'exclamation-triangle' : type === 'success' ? 'check-circle' : 'info-circle'} me-2"></i>
                    ${message}
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
        `;

        toastContainer.appendChild(toast);

        const bsToast = new bootstrap.Toast(toast, {
            autohide: true,
            delay: 4000
        });
        bsToast.show();

        toast.addEventListener('hidden.bs.toast', () => {
            toast.remove();
        });
    }

    // Enhanced back to top button visibility
    window.addEventListener('scroll', function() {
        const backBtn = document.querySelector('.back-btn');
        if (window.scrollY > 400) {
            backBtn.style.display = 'block';
        } else {
            backBtn.style.display = 'none';
        }
    });

    // Add loading animation on page load
    window.addEventListener('load', function() {
        document.body.style.opacity = '0';
        document.body.style.transition = 'opacity 0.5s ease';
        setTimeout(() => {
            document.body.style.opacity = '1';
        }, 100);
    });

    // ===== WEATHER FUNCTIONALITY ===== 
    async function loadWeatherForDestination() {
        const destinationLocation = '{{ destination.location }}';
        const cityName = destinationLocation.split(',')[0].trim();
        
        console.log('🌤️ Loading weather for:', cityName);
        
        try {
            showCurrentWeatherLoading();
            
            const response = await fetch(`/api/weather/${encodeURIComponent(cityName)}`);
            const data = await response.json();
            
            console.log('🌤️ Weather API response:', data);
            
            if (data.success) {
                displayCurrentWeather(data);
            } else {
                console.error('❌ Weather API error:', data.error);
                showCurrentWeatherError();
            }
        } catch (error) {
            console.error('❌ Weather fetch error:', error);
            showCurrentWeatherError();
        }
    }

    function showCurrentWeatherLoading() {
        document.getElementById('currentWeatherLoading').classList.remove('d-none');
        document.getElementById('currentWeatherError').classList.add('d-none');
        document.getElementById('currentWeatherContent').classList.add('d-none');
    }

    function showCurrentWeatherError() {
        document.getElementById('currentWeatherLoading').classList.add('d-none');
        document.getElementById('currentWeatherError').classList.remove('d-none');
        document.getElementById('currentWeatherContent').classList.add('d-none');
    }

    function displayCurrentWeather(data) {
        console.log('🌤️ Displaying current weather data:', data);
        
        // Safely update elements with null checks
        const updateElement = (id, content) => {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = content;
            }
        };
        
        const updateElementSrc = (id, src, alt) => {
            const element = document.getElementById(id);
            if (element) {
                element.src = src;
                element.alt = alt;
            }
        };
        
        document.getElementById('currentWeatherLoading').classList.add('d-none');
        document.getElementById('currentWeatherError').classList.add('d-none');
        document.getElementById('currentWeatherContent').classList.remove('d-none');
        
        // Populate current weather data with null checks
        updateElement('currentWeatherLocation', `${data.city}, ${data.country}`);
        updateElement('currentWeatherTime', data.time);
        
        // Fix icon URL - use the correct property from API response
        const iconCode = data.weather_icon || data.icon || '01d'; // fallback to clear sky
        updateElementSrc('currentWeatherIcon', `https://openweathermap.org/img/wn/${iconCode}@2x.png`, data.weather_description || data.description || 'Weather');
        
        updateElement('currentTemperature', `${data.temperature}°C`);
        updateElement('currentWeatherDesc', data.weather_description || data.description || 'Clear sky');
        
        // Update high/low temperature (you can get this from forecast data or set default)
        const highTemp = data.temp_max || data.temperature + 3; // fallback
        const lowTemp = data.temp_min || data.temperature - 8; // fallback
        updateElement('currentHighLow', `H ${Math.round(highTemp)}° L ${Math.round(lowTemp)}°`);
        
        // Only update these if elements exist
        updateElement('currentHumidity', `${data.humidity}%`);
        updateElement('currentWindSpeed', `${data.wind_speed} m/s`);
        updateElement('currentPressure', `${data.pressure} hPa`);
        updateElement('currentVisibility', `${data.visibility} km`);
        updateElement('currentSunrise', data.sunrise);
        updateElement('currentSunset', data.sunset);
    }

    // ===== HERO WEATHER FUNCTIONALITY (DISABLED - NOW USING MAIN WEATHER SECTION) ===== 
    /* async function loadHeroWeather() {
        const destinationLocation = '{{ destination.location }}';
        const cityName = destinationLocation.split(',')[0].trim();
        
        console.log('🌤️ Loading hero weather for:', cityName);
        
        try {
            showHeroWeatherLoading();
            
            const response = await fetch(`/api/weather/${encodeURIComponent(cityName)}`);
            const data = await response.json();
            
            console.log('🌤️ Hero Weather API response:', data);
            
            if (data.success) {
                displayHeroWeather(data);
            } else {
                console.error('❌ Hero Weather API error:', data.error);
                showHeroWeatherError();
            }
        } catch (error) {
            console.error('❌ Hero Weather fetch error:', error);
            showHeroWeatherError();
        }
    }

    function showHeroWeatherLoading() {
        document.getElementById('heroWeatherLoading').classList.remove('d-none');
        document.getElementById('heroWeatherError').classList.add('d-none');
        document.getElementById('heroWeatherContent').classList.add('d-none');
    }

    function showHeroWeatherError() {
        document.getElementById('heroWeatherLoading').classList.add('d-none');
        document.getElementById('heroWeatherError').classList.remove('d-none');
        document.getElementById('heroWeatherContent').classList.add('d-none');
    }

    function displayHeroWeather(data) {
        console.log('🌤️ Displaying hero weather data:', data);
        
        document.getElementById('heroWeatherLoading').classList.add('d-none');
        document.getElementById('heroWeatherError').classList.add('d-none');
        document.getElementById('heroWeatherContent').classList.remove('d-none');
        
        // Populate hero weather data
        document.getElementById('heroWeatherLocation').textContent = `${data.city}, ${data.country}`;
        document.getElementById('heroWeatherTime').textContent = data.timestamp;
        document.getElementById('heroWeatherIcon').src = `https://openweathermap.org/img/wn/${data.weather_icon}@2x.png`;
        document.getElementById('heroWeatherIcon').alt = data.weather_description;
        document.getElementById('heroTemperature').textContent = `${data.temperature}°C`;
        document.getElementById('heroWeatherDesc').textContent = data.weather_description;
        document.getElementById('heroFeelsLike').textContent = `Feels like ${data.feels_like}°C`;
        document.getElementById('heroHumidity').textContent = `${data.humidity}%`;
        document.getElementById('heroWindSpeed').textContent = `${data.wind_speed} m/s`;
        document.getElementById('heroPressure').textContent = `${data.pressure} hPa`;
        document.getElementById('heroVisibility').textContent = `${data.visibility} km`;
        document.getElementById('heroSunrise').textContent = `Sunrise: ${data.sunrise}`;
        document.getElementById('heroSunset').textContent = `Sunset: ${data.sunset}`;
    } */

    // ===== 5-DAY FORECAST FUNCTIONALITY =====
    let forecastLoaded = false;

    function toggleForecast() {
        const forecastContent = document.getElementById('forecastContent');
        const toggleButton = document.querySelector('.forecast-toggle');
        const isVisible = !forecastContent.classList.contains('d-none');
        
        if (isVisible) {
            forecastContent.classList.add('d-none');
            if (toggleButton) {
                toggleButton.innerHTML = '<i class="fas fa-calendar-alt me-2"></i>Show Forecast';
            }
        } else {
            forecastContent.classList.remove('d-none');
            if (toggleButton) {
                toggleButton.innerHTML = '<i class="fas fa-calendar-alt me-2"></i>Hide Forecast';
            }
            
            // Load forecast if not already loaded
            if (!forecastLoaded) {
                loadForecast();
            }
        }
    }

    async function loadForecast() {
        const destinationLocation = '{{ destination.location }}';
        const cityName = destinationLocation.split(',')[0].trim();
        
        console.log('🌤️ Loading 5-day forecast for:', cityName);
        
        try {
            showForecastLoading();
            
            const response = await fetch(`/api/weather/forecast/${encodeURIComponent(cityName)}`);
            const data = await response.json();
            
            console.log('🌤️ Forecast API response:', data);
            
            if (data.success) {
                displayForecast(data);
                forecastLoaded = true;
            } else {
                console.error('❌ Forecast API error:', data.error);
                showForecastError();
            }
        } catch (error) {
            console.error('❌ Forecast fetch error:', error);
            showForecastError();
        }
    }

    function showForecastLoading() {
        document.getElementById('forecastLoading').classList.remove('d-none');
        document.getElementById('forecastError').classList.add('d-none');
        document.getElementById('forecastContent').classList.add('d-none');
    }

    function showForecastError() {
        document.getElementById('forecastLoading').classList.add('d-none');
        document.getElementById('forecastError').classList.remove('d-none');
        document.getElementById('forecastContent').classList.add('d-none');
    }

    function displayForecast(data) {
        console.log('🌤️ Displaying forecast data:', data);
        
        document.getElementById('forecastLoading').classList.add('d-none');
        document.getElementById('forecastError').classList.add('d-none');
        document.getElementById('forecastContent').classList.remove('d-none');
        
        const forecastDays = document.getElementById('forecastDays');
        forecastDays.innerHTML = '';
        
        data.forecast.forEach((day, index) => {
            const dayElement = document.createElement('div');
            dayElement.className = 'forecast-day';
            dayElement.style.animationDelay = `${index * 0.1}s`;
            
            // Format date
            const date = new Date(day.date);
            const formattedDate = date.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric' 
            });
            
            dayElement.innerHTML = `
                <div class="fc-card">
                    <div class="fc-day-header">${day.day_name}</div>
                    <div class="fc-icon-wrap">
                        <img src="https://openweathermap.org/img/wn/${day.weather_icon}@2x.png" 
                             alt="${day.weather_description}" 
                             class="forecast-day-icon">
                    </div>
                    <div class="fc-desc">${day.weather_description}</div>
                    <div class="fc-temp-band">
                        <div class="fc-temp-high">${day.max_temp}°</div>
                        <div class="fc-temp-low">${day.min_temp}°</div>
                    </div>
                </div>
            `;
            
            forecastDays.appendChild(dayElement);
        });
        
        // Add animation to forecast days
        const forecastDayElements = forecastDays.querySelectorAll('.forecast-day');
        forecastDayElements.forEach((element, index) => {
            element.style.opacity = '0';
            element.style.transform = 'translateY(20px)';
            setTimeout(() => {
                element.style.transition = 'all 0.5s ease';
                element.style.opacity = '1';
                element.style.transform = 'translateY(0)';
            }, index * 100);
        });
    }

    // Load weather when page loads
    document.addEventListener('DOMContentLoaded', function() {
        console.log('📄 Page loaded, initializing weather...');
        setTimeout(() => {
            loadWeatherForDestination();
            loadForecast(); // Load forecast automatically
        }, 1000);
    });

    // Refresh weather every 10 minutes
    setInterval(loadWeatherForDestination, 600000);
</script>
{% endblock %}
